# Поиск заинтересованных лиц

## Поиск дополнительных (к уроку) стейкхолдеров
| Дополнительные <br>стейкхолдеры | Консёрны                                                                                                           |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| Кадровики                       | Учет рабочего времени воркера (основное, пеработки)<br>Планирование отпусков воркера и "отправка" воркера в отпуск |
| Склад                           | Нужно планирование поставок и заказ расходников                                                                    |
| Маркетинг                       | Акции среди клиентов                                                                                               |

## Распределение стейкхолдеров по группам

[Матрица](https://github.com/cvartan/system-analysis/blob/main/homework3/stakeholder_matrix.png)

| Стейкхолдер      | Группа          | Комментарий                                                                                                                                                                                                     |
| ---------------- | --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Топ-менеджмент   | Высокое-высокое | По названию у группы высокое влияние и высокая заинтересованность в проекте (так как это их бизнес).<br>К тому же от них исходят основные требования, которые мы до этого рассматривали                         |
| Менеджеры        | Высокое-высокое | Высокое влияние и высока заинтересованность - так как во многом эта система делается для облегчения выполнения процессов, за которые они отвечают.                                                              |
| Финотдел         | Высокое-низкое  | Высокое влияние, но не такая высокая заинтересованность - тут главное чтобы была качественно закрыта финансовая сторона бизнеса                                                                                 |
| Разработчики     | Низкое-высокое  | Низкое влияние (исполнители), но высокая заинтересованность, так как им делать эту систему и лучше не создавать себе лишних проблем.                                                                            |
| Админы           | Низкое-высокое  | Низкое влияние (исполнители), но высокая заинтересованность, так как им эту систему эксплуатировать и лучше не создавать себе лишних проблем.                                                                   |
| Юристы           | Низкое-низкое   | Низкое влияние и низкая заинтересованность - сами с системой не работают, профит от ее использования не получают, но в правовом поле формально все должно быть закрыто                                          |
| Клиенты          | Низкое-низкое   | Низкое влияние и низкая заинтересованность (они потом выскажут свое мнение о системе) - хотя им самим и надо будет работать с системой и их мнение также важно учитывать (чтобы потом высказались не так грубо) |
| Кадровики (доп.) | Низкое-низкое   | Низкое влияние и низкая заинтересованность - сами с системой не работают, профит от ее использования не получают, но в правовом поле (трудовое законодательство) формально все должно быть закрыто              |
| Маркетинг (доп.) | Низкое-высокое  | Низкое влияние и высокая заинтересованность - так как система воспринимается как инструмент для работы с клиентами (с учетом того, что в планах выход на открытый рынок)                                        |
| Склад (доп.)     | Низкое-высокое  | Низкое влияние и высокая заинтересованность - сами же работают в системе                                                                                                                                        |

## Оценка консернов
[Схема](https://github.com/cvartan/system-analysis/blob/main/homework3/stakeholder_concerns.png)

| Стейкхолдер    | Консерн                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Важность | Комментарий                                                                                                                                                                                                                                                                    |
| -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Топ-менеджмент | Скоринг потенциальных работников уникален в своём роде, и логика его работы сильно выше, чем планировалось. Бизнес в будущем хочет продавать его другим компаниям и тестировать больше гипотез;                                                                                                                                                                                                                                                                                                               | высокая  | Нужно учесть, что данный сервис должен быть отчуждаем (то есть взяли сервис и продали его другой компании)<br>Также сервис будет развиваться не только по потребностям MCF, но могут "прилетать" требования от других компаний - это не должно влиять на работу сервиса в MCF) |
|                | релизный цикл для всей системы — месяц, для скоринга работников — неделя максимум.                                                                                                                                                                                                                                                                                                                                                                                                                            | высокая  | Конкретное требование (а не просто декларация намерений)<br>Влияет на архитектуру и процесс разработки.                                                                                                                                                                        |
|                | хочет, чтобы система была максимально во власти компании, это касается как данных, так и кода. Это связано либо со страхом потерять данные или доступ, либо с утечками, которые повлияют на конкурентоспособность компании. Покупка любых решений должна быть обоснована на 40 листах А4 (без такого обоснования бизнес сразу отказывает). Единственное исключение — печенье, которым бизнес не хочет заниматься, и интеграция с сервисом «Золотая шляпа», тут бизнес признал необходимость сторонних систем. | высокая  | Конкретное требование.<br>Задает требования к используемой инфраструктуре разработки и эксплуатации.                                                                                                                                                                           |
| Менеджеры      | хотят, чтобы о системе ставок не знали другие отделы, иначе будет некрасивая ситуация. Они хотят скрыть эту систему даже от разработчиков, которые не будут ей заниматься, и от начальства                                                                                                                                                                                                                                                                                                                    | низкая   | тут больше пожелание<br>которе еще и противоречит требованиям топ-менеджмента о том, что все данные внутри компании                                                                                                                                                            |
|                | выяснилось, что котам из Happy Cat Box наш проект понравился, поэтому приходит не 10 заказов в день, а 10 заказов в минуту.                                                                                                                                                                                                                                                                                                                                                                                   | высокое  | Такое повышение performance может достаточно сильно повлиять на архитектуру, реализацию и инфраструктуру для эксплуатации системы.                                                                                                                                             |
| Финотдел       | списывать деньги с клиентов каждую неделю слишком затратно для отдела, поэтому они хотят списывать деньги раз в месяц, но платить воркерам и дальше раз в месяц                                                                                                                                                                                                                                                                                                                                               | низкое   | Сильно на систему не влияет. Тут болше - "перенастроить крон".<br>Но возможность настройки цикла биллинга стоит добавить.                                                                                                                                                      |
|                | При этом необходимо постоянно добавлять новые способы списания денег для клиентов. Воркеры всегда работают через компанию «Золотая шляпа»;                                                                                                                                                                                                                                                                                                                                                                    | высокое  | В системе необходимо учесть возможность подключения разных платежных систем и подключение это должно быть достаточно быстрым (отсюда возможно стоит посмотреть на архитектуру системы - на те же самые субдомены и контексты).                                                 |
|                | боятся потерять любую финансовую информацию и хотят решение, которое будет гарантировать, что всё будет ок.                                                                                                                                                                                                                                                                                                                                                                                                   | высокое  | Высокое - потому что нужно предусматривать систему защиты информации.                                                                                                                                                                                                          |
| Разработчики   | система должна работать без сбоев, а если сбой случается, то должно быть понятно, что и где чинить.                                                                                                                                                                                                                                                                                                                                                                                                           | высокое  | Высокое - потому что в связи с низким TTM надо быстро и максимально качественно вносить изменения в код, а не разбираться как это все работает                                                                                                                                 |
| Админы         | простота мониторинга системы для своевременного замечания сбоев, чтобы не работать в авральном режиме.                                                                                                                                                                                                                                                                                                                                                                                                        | высокое  | Необходимо при разработке предусмотреть как будем мониторить работу системы                                                                                                                                                                                                    |
| Юристы         | соответствие всей системы правовым нормам.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | низкое   | Общее требование.<br>Понятно, что не планируем делать что-то противозаконное (ну думаю что MCF все-таки не тайная хакерская организация)                                                                                                                                       |
| Клиенты        | ожидаемое поведение системы: без сбоев и тупняков.                                                                                                                                                                                                                                                                                                                                                                                                                                                            | низкое   | Также - никто не хочет делать сбойную и тормозную систему                                                                                                                                                                                                                      |
|                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |          |                                                                                                                                                                                                                                                                                |
| Кадровики      | Учет рабочего времени воркера (основное, пеработки)                                                                                                                                                                                                                                                                                                                                                                                                                                                           | высокое  | Как раз можно отнести к конертному требованию по правовой чистоте (воркерам нельзя сильно перерабатывать - а то потом засудят)                                                                                                                                                 |
|                | Планирование отпусков воркера и "отправка" воркера в отпуск                                                                                                                                                                                                                                                                                                                                                                                                                                                   | низкое   | Тут пока можно обойтись и без системы (а контроль рабочего времени поможет если воркер в отпуске начнет работать)                                                                                                                                                              |
| Склад          | Нужно планирование поставок и заказ расходников                                                                                                                                                                                                                                                                                                                                                                                                                                                               | высокое  | Надо учесть в системе, так как базу расходников надо как-то формировать                                                                                                                                                                                                        |
| Маркетинг      | Акции среди клиентов                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | высокое  | Хотя требование и общее, но возможность гибкой настройки правил оплаты клиентами заказов надо добавить (ну и возможно в этой части может быть более короткий релизный цикл при активном маркетинге)                                                                            |

# Выбор архитектурного стиля
## Распределение характеристик по контекстам
[Схема](https://github.com/cvartan/system-analysis/blob/main/homework3/context_capability.png)

## Атомарные элементы
| Элемент                               | Контексты                             | Комментарий                                                                                                                                                                                |
| ------------------------------------- | ------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Наем воркеров                         | Наем воркеров                         | В дальнейшем планируется выделить в отдельный продукт                                                                                                                                      |
| Тотализатор                           | Тотализатор                           | Будет вообще разрабаваться сторонней командой                                                                                                                                              |
| Взаимодействие с клиентами по заказам | Взаимодействие с клиентами по заказам |                                                                                                                                                                                            |
| Исполнение заказов                    | Исполнение заказов                    | Хоть тесно и связан по обработке с взаимодействием с клиентами, но разные темпы обработки.<br>Тут воркеры не факт что смогут исполнять 10 заказов в минуту                                 |
| Подбор воркера на услугу              | Подбор воркера на услугу              | По новым требованиям алгоритм пошаговый с возможностью изменения последовательности шагов.<br>К тому же часть кода скорее всего будет реализовываться другой командой на сосьвенных языках |
| Контроль качества заказов             | Контроль качества заказов             | Отдельный темп обработки данных по заказам чем даже у исполнения.                                                                                                                          |
| Расчеты с клиентами                   | Расчеты с клиентами                   |                                                                                                                                                                                            |
| Расчеты с воркерами                   | Расчеты с воркерами                   |                                                                                                                                                                                            |
| Комплектование заказов                | Комплектование заказов                |                                                                                                                                                                                            |
|                                       | Заказа печенья                        | По сути вообще внешний сервис. Причем работающий внутри комплектования заказов.                                                                                                            |

## Выбор

Стиль всей системы - **микросервисный** (выбор по характеристикам общим для всех контекстов: agility, deployability, testability)

| Характеристика системы | layered | modular monolith | service-based | microservices | microkernel | pipeline | event-driven |
| ---------------------- | ------- | ---------------- | ------------- | ------------- | ----------- | -------- | ------------ |
| agility                | 1       | 2                | 4             | 5             | 3           | 2        | 3            |
| deployability          | 1       | 2                | 4             | 4             | 3           | 2        | 3            |
| testablity             | 2       | 2                | 4             | 4             | 3           | 3        | 2            |


В целом для основной массы сервисов выбирается стиль layered-монолит, так как:
- логика достаточно простая, связанная с одним контекстом
- изменяемость логики отдельных "операций" одинаковая (нет такого, что что-то меняется редко, а что-то надо постоянно менять)
- простое решение.

| Сервис                                | Стиль       | Комментарий                                                                                                                                                                                                                                                                    |
| ------------------------------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Наем воркеров                         | microkernel | Для возможности выделения дополнительных функций от внешних потребителей (так как есть консерн на продажу этого сервиса как отдельного продукта) в виде плагинов к базовой функциональности                                                                                    |
| Тотализатор                           | layered     |                                                                                                                                                                                                                                                                                |
| Взаимодействие с клиентами по заказам | layered     |                                                                                                                                                                                                                                                                                |
| Исполнение заказов                    | layered     |                                                                                                                                                                                                                                                                                |
| Подбор воркера на услугу              | pipeline    | Надо настравивать последовательность шагов. Ключевая характеристика: wokflow                                                                                                                                                                                                   |
| Контроль качества заказов             | layered     |                                                                                                                                                                                                                                                                                |
| Расчеты с клиентами                   | microkernel | Подключение к разным платежным системам можно делать через плагины<br>Акции для клиентов также реализовывать через плагины<br>Ключевая характеристика: modularity, configutability                                                                                             |
| Расчеты с воркерами                   | layered     |                                                                                                                                                                                                                                                                                |
| Комплектование заказов                | модульный   | Тут выбор обусловлен тем, что возможно потребуется отдельный модуль на заказ расходников (из требований стейкхолжеров обнаруженных мной - т.е. склада)<br>Ключевая характеристика: domain part (но выбор модульного - в том что он проще и понятнее для данной характеристики) |



# Выбор базы данных
Так как выбрана микросервисная архитектура, то для каждого сервиса - своя база данных
| Сервис                                | Тип БД      | Комментарий                                                                                                                                                                |
| ------------------------------------- | ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Наем воркеров                         | RDBMS       | Структура данных достаточно типизированная<br>Выборки также фиксированы                                                                                                    |
| Тотализатор                           | RDBMS       | Структура данных достаточно типизированная<br>Выборки также фиксированы                                                                                                    |
| Взаимодействие с клиентами по заказам | RDBMS       | Структура данных достаточно типизированная<br>Выборки также фиксированы<br>Но дополнительно выбрана документарная БД, так как есть обмен подтверждающими документами       |
| Исполнение заказов                    | RDBMS       | Структура данных достаточно типизированная                                                                                                                                 |
| Подбор воркера на услугу              | Graph       | Так как здесь предполагается слабая типизация данных и решения строятся на анализе данных                                                                                  |
| Контроль качества заказов             | Documentary | Структура данных недостаточно типизирована, но при этом видится достаточно много документарной информации - например, переписка с клиентами и воркерами, заключения и т.д. |
| Расчеты с клиентами                   | RDBMS       | Структура данных достаточно типизированная<br>Выборки также фиксированы                                                                                                    |
| Расчеты с воркерами                   | RDBMS       | Структура данных достаточно типизированная<br>Выборки также фиксированы                                                                                                    |
| Комплектование заказов                | RDBMS       | Структура данных достаточно типизированная<br>Выборки также фиксированы                                                                                                    |
# Выбор стиля коммуникаций
В целом для взаимодействия между сервисами преполагается использование Event-Driven подхода так как он более масштабируем и уменьшает зависимость (сервисы реагируют на события).
При этом для обращения к внешним сервисам скорее всего будет использоваться стиль Request-Response с ограничениями:
| Коммуникация                            | Тип (синх./асинх.)                                                 | Комментарий                                                                                                 |
| --------------------------------------- | ------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------- |
| Комплектование заказов - Заказ печенья  | асинхронный                                                        | Тут только асинхронный способ взаимодействия, так как ответ (готовность печенья) не может подготовлен сразу |
| Расчеты с клиентами - Платежная система | определяется контрактом сервиса, но скорее всего будет асинхронный |                                                                                                             |
| Расчеты с воркерами - Золотая шляпа     | определяется контрактом сервиса, но скорее всего будет асинхронный |                                                                                                             |
# Фитнесс-функции для валидации
| Сервис                                | Фитнес-функции                                                                                                                                                                                                                                                                                                                                           |
| ------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Система в целом                       | покрытие тестами на 90%<br>создание новых очередей - через согласование<br>подключение внешних сервисов - через согласование<br>использование schema-registry для событий<br>проверка периодичности релиза - 1 раз в месяц (кроме найма воркеров)                                                                                                        |
| Взаимодействие с клиентами по заказам | проверка выполнения основных функциональных сценариев (разработка интеграционных тестов для каждого сценария (+различные результаты) и запуск при сборке проекта)<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion                                                                                                       |
| Исполнение заказов                    | проверка выполнения основных функциональных сценариев (разработка интеграционных тестов для каждого сценария (+различные результаты) и запуск при сборке проекта)<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion                                                                                                       |
| Подбор воркера на услугу              | проверка гарантированности получения воркера на задачу (набор тестов выполняемых при сборке и деплое)<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion                                                                                                                                                                   |
| Контроль качества заказа              | проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion                                                                                                                                                                                                                                                                            |
| Расчеты с клиентами                   | проверка выполнения основных функциональных сценариев и алгоритмов расчета (разработка интеграционных тестов для каждого сценария (+различные результаты) и запуск при сборке проекта)<br>проверка доступности платежных систем и соответствие взаимодействия контракту<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion |
| Расчеты с воркерами                   | проверка выполнения основных функциональных сценариев и алгоритмов расчета (разработка интеграционных тестов для каждого сценария (+различные результаты) и запуск при сборке проекта)<br>проверка доступности Золотой шляпы и соответствие взаимодействия контракту<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion    |
| Комплектование заказов                | проверка выполнения основных функциональных сценариев (разработка интеграционных тестов для каждого сценария (+различные результаты) и запуск при сборке проекта)<br>проверка доступности сервиса для заказа печенья и соответсвие взаимодействия контракту<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion             |
| Наем воркеров                         | проверка выполнения основных функциональных сценариев (разработка интеграционных тестов для каждого сценария (+различные результаты) и запуск при сборке проекта)<br>проверка доступности сервиса для заказа печенья и соответсвие взаимодействия контракту<br>проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion             |
| Тотализатор                           | проверка реализации архитектурного стиля<br>анализ метрик coupling и cohesion                                                                                                                                                                                                                                                                            |
# ADR
Ссылка: https://github.com/cvartan/system-analysis/blob/main/homework3/ADR%20MCF.pdf 